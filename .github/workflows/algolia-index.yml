name: update algolia index (web_posts_dev)

on:
  push:
    branches:
      - dev
      - ft/content-onedge

jobs:
  update-index:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 18
          cache: yarn
      - run: touch .env
      - run: echo ALGOLIA_APP_ID=$value >> .env
        env: {value: "${{ secrets.ALGOLIA_APP_ID }}"} 
      - run: echo ALGOLIA_SEARCH_API_KEY=$value >> .env
        env: {value: "${{ secrets.ALGOLIA_SEARCH_API_KEY }}"} 
      - run: echo ALGOLIA_WRITE_API_KEY=$value >> .env
        env: {value: "${{ secrets.ALGOLIA_WRITE_API_KEY }}"} 
      - run: yarn
      - run: yarn workspace algolia-index-workspace update-index
