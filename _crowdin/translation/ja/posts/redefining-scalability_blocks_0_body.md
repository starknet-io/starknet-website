ブロックチェーンのスケーラビリティは常に熱いトピックでした。 ほぼすべてのブロックチェーンネットワークは、1秒あたりの多数のトランザクション(TPS)をセールスポイントとして宣伝しています。 しかし、TPSはブロックチェーンネットワークとを比較するのに妥当なメトリックではありません。ブロックチェーンネットワークの相対的なパフォーマンスを評価することは困難です。 さらに、大きなTPS番号は通常コストがかかります。つまり、これらのネットワークは実際に拡大するのかという疑問を提起します。 それとも単にスループットを向上させるのか?

それでは、スケーラビリティを定義する方法と、それを達成するためにトレードオフが行われる方法、そして究極のスケーラビリティソリューションが妥当性ロールアップである理由を検討しましょう。

### すべての取引が均等になっているわけではありません

最初に、TPSのシンプルで便利な指標がスケーラビリティの正確な尺度ではないという主張を確立する必要があります。

トランザクションを実行するためのノードを補償するため(およびユーザーが不要な計算でネットワークをスパムすることを防ぐため) ブロックチェーンはブロックチェーンに課された計算負担に比例した手数料を請求します。 イーサリアムでは、計算負荷の複雑さは*ガスで測定されます。*ガスはトランザクションの複雑さの非常に便利な尺度であるため、この用語は、通常はイーサリアム固有ですが、この記事全体でイーサリアム以外のブロックチェーンにも使用されます。

取引は複雑で大きく異なり、したがって、どのくらいのガスを消費するかが異なります。 信頼できないピアツーピア取引のパイオニアであるBitcoinは、基本的なBitcoinスクリプトのみをサポートしています。 住所から住所へのこれらの簡単な転送は少量のガスを使用します。 対照的に、EthereumやSolanaのようなスマートコントラクトチェーンは、はるかに複雑なトランザクションを可能にする仮想マシンとTuring-completeプログラミング言語をサポートしています。 したがって、UniswapのようなdAppははるかに多くのガスを必要とします。

このため、異なるブロックチェーンのTPSを比較するのは意味がありません。 代わりに比較すべきなのは、計算能力、つまりスループットです。

すべてのブロックチェーンには、ブロックサイズとブロック時間があり、*計算単位の数*をブロックごとに処理し、*高速*新しいブロックを追加する方法を決定します。 これら2つの変数を組み合わせて、ブロックチェーンの*スループット*を決定します。

### スケーラビリティを制限するには?

ブロックチェーンは、最大限に分散型の包括的なネットワークになるよう努めています。 これを達成するためには、二つの基本的な特性をチェックする必要があります。

#### **1. ハードウェア要件**

ブロックチェーンネットワークの分散化は、ネットワーク内で最も脆弱なノードがブロックチェーンを検証し、その状態を保持する能力によって決定されます。 したがって、ノード(ハードウェア、帯域幅)を実行するためのコストです。 できるだけ多くの人がトラストレスのないネットワークの参加者になるためには、できるだけ低くしておく必要があります。

#### 2**.**状態成長

国家の成長とは、ブロックチェーンがどれくらい早く成長するかを指します。 ブロックチェーンのスループットが単位時間当たりに発生するほど、ブロックチェーンはより速く成長します。 フルノードはネットワークの履歴を保存し、ネットワークの状態を検証できる必要があります。 Ethereumの状態は、ツリーなどの効率的な構造を使用して保存され参照されます。 状態が成長するにつれて、新しい葉と枝が追加され、特定のアクションを実行するためにそれがますます複雑で時間がかかるようになります。 チェーンのサイズが大きくなるにつれて、ノードごとの最悪の場合の実行が悪化し、新しいブロックを検証するための時間が増え続けます。 これにより、フルノードが同期するのにかかる総時間も増加します。

### スループットを増加させる有害な影響

#### 1. ノード数

ノードとノード数を実行するための最小要件は次のとおりです。

* Bitcoin1: 350GB HDDディスク容量、5 Mbit/s接続、1GB RAM、CPU >1 Ghz。 **ノード数: ~10,000**
* Ethereum2:500GB+ SSDディスク容量、25Mbit/s接続、4–8GBのRAM、CPU2–4コア。 **ノード数: 〜6,000**
* Solana3: 1.5TB+ SSDディスク容量, 300 Mbit/s接続, 128GB RAM CPU 12+ コア. **ノード数: ~1,200**

ブロックチェーンのスループットに必要なノードのCPU、帯域幅、およびストレージ要件が大きいことに注意してください。 ネットワーク上のノードが少ないほど、分散化が弱まり、包括的なネットワークが少なくなります。

#### 2. フルノードを同期する時間

初めてノードを実行する場合は、既存のすべてのノード、ダウンロードに同期する必要があります。 ネットワークの状態を検証しますジェネシスブロックから チェーンの先端まで このプロセスは、誰もがプロトコルの権限のない参加者として行動することを可能にするために、可能な限り迅速かつ効率的でなければなりません。

Jameson Loppの[2020 Bitcoin Node](https://blog.lopp.net/2020-bitcoin-node-performance-tests/)と[2021 Node Sync Tests](https://blog.lopp.net/2021-altcoin-node-sync-tests/)をインジケータとして取ります 表1は、Bitcoinの完全なノードを同期するのにかかる時間を比較しています。 平均的な消費者グレードPC上のEthereum対Solana。

![表1. ブロックチェーンのスループットとノード同期比較](/assets/1_gmpi_1c9zipoc-znrh7b5q.png "表1. ブロックチェーンのスループットとノード同期比較")

表1は、スループットの向上により、より多くのデータを処理して保存する必要があるため、同期時間が長くなることを示しています。

ノードソフトウェアの改善は、成長するブロックチェーンの課題を緩和するために常に行われていますが(ディスクのフットプリントを下げる)。 同期速度の高速化クラッシュ回復力の強化 特定の部品のモジュール化 ノードはスループットの向上に対応できないことが明らかです。

### スケーラビリティをどのように定義すべきか?

スケーラビリティはブロックチェーンの空間において最も誤った表現である。 スループットを向上させることが望ましいですが、パズルの一部に過ぎません。

***スケーラビリティ**は、**同じ**ハードウェアの**より多くのトランザクション** を意味します。*

そのため、スケーラビリティは2つのカテゴリーに分けられます。

#### シーケンサーの拡張性

シーケンシングは、ネットワーク内のトランザクションを順序付け、処理する行為を記述します。 以前に設立されたように 任意のブロックチェーンは、ブロックサイズを上げてブロック時間を短縮することによって、そのスループットを些細に向上させることができます - その分散化への負の影響があまりにも重要であると考えられるポイントまで。 しかし、これらの単純なパラメータを調整することは、必要な改善を提供しません。 EthereumのEVMは理論的には[最大2,000 TPS](https://twitter.com/dankrad/status/1459607325854121989)を処理することができます。これは長期的なブロックスペースの需要を満たすには不十分です。 シーケンシングをスケールするために、Solanaはいくつかの印象的な革新をしました:並列化可能な実行環境と巧妙なコンセンサスメカニズムを利用して。 はるかに効率的なスループットを可能にします しかし、その改善にもかかわらず、それは十分でもスケーラブルでもありません。 Solanaのスループットが向上すると、ノードを実行し、トランザクションを処理するためのハードウェアコストも増加します。

#### スケーラビリティの検証

*検証のスケーラビリティは、絶えず増加するハードウェアコストを持つノードを負担することなくスループットを向上させるアプローチを記述しています。*具体的には、妥当性証明のような暗号技術革新を指します。 これらは、Vality Rolloupsがブロックチェーンを持続的に拡大できる理由です。

**有効ロールとは何ですか？**

妥当性ロールアップ（「ZK-Rollups」とも呼ばれます）は、計算と状態ストレージをオフチェーンに移動しますが、特定のデータの少量をチェーン上に保持します。 基盤となるブロックチェーン上のスマートコントラクトは、Rollupの状態ルートを維持します。 Rollupでは、現在の状態ルートとともに、高度に圧縮されたトランザクションのバッチがオフチェーンProverに送信されます。 プローバーはトランザクションを計算し、結果の妥当性証明と新しいステートルートを生成し、それをオンチェーン検証器に送信します。 検証器は有効性証明を検証します。 そして、Rollupの状態を維持するスマートコントラクトは、Proverが提供する新しい状態に更新します。

**同じハードウェア要件に応じて、妥当性ロールアップはどのように拡張されますか?**

プロバーズはハイエンドのハードウェアを必要としますが、ブロックチェーンの分散化には影響しません。 取引の妥当性は数学的に検証可能な証明によって保証されているからです

重要なのは、証明を検証するための要件です。 関連するデータは高度に圧縮され、計算によって大部分が抽象化されているため、基盤となるブロックチェーンのノードへの影響は*です。*

検証器(Ethereumノード)はハイエンドのハードウェアを必要とせず、バッチのサイズはハードウェア要件を増大させません。 ステート遷移と少量のコールデータのみがノードによって処理および保存される必要があります。 これにより、すべてのEthereumノードは既存のハードウェアを使用してVality Rollupバッチを検証できます。

**取引が多ければ多いほど、安くなります**

従来のブロックチェーンでは、より多くのトランザクションが発生します ブロックスペースがいっぱいになるにつれて、誰にとっても高価になります。そして、ユーザーは取引を含めるために手数料市場でお互いに高く入札する必要があります。

「妥当性のロールアップ」の場合、このダイナミックは逆になります。 Ethereumでトランザクションのバッチを検証するには、一定のコストがかかります。 バッチ内の取引数が増えるにつれて、バッチを検証するためのコストは指数関数的に遅くなります。 バッチにトランザクションを追加すると、バッチ検証コストが上昇しても、より安価なトランザクション手数料が発生します。バッチ内のすべてのトランザクション間で償却されるためです。 有効性 ロールアップはバッチ内でできるだけ多くのトランザクションを必要とし、すべてのユーザー間で検証料を共有できるようにします。 バッチサイズが無限大になると、トランザクションあたりの償却手数料はゼロに収束します。 、Validity Rollupでより多くのトランザクションは、誰にとっても安価になります。

dYdXは、Validity Rollupを搭載したdAppで、12,000以上のトランザクションのバッチサイズが頻繁に表示されます。 メインネット上で同じトランザクションのガス消費量と妥当性の比較 Rollupはスケーラビリティの向上を示しています。

Ethereum MainnetでdYdXトランザクションを決済中:**200,000 gas**

StarkExでdYdXトランザクションを決済中:**<500のガス**

もう一つの見方: 妥当性ロールアップのメインコストは、同じバッチ内のユーザー数と直線的に調整されます。

#### なぜ楽観的なロールアップが考えられるほど拡張性がないのか

理論的には、楽観的なロールアップは、妥当性ロールアップとほぼ同じスケーラビリティの利点を提供します。 しかし、一つの重要な違いがあります:楽観的なロールアップは、平均的なケースを最適化しますが、妥当性ロールアップは最悪の場合を最適化します。 ブロックチェーンシステムは極めて敵対的な状態で動作するため、最悪の場合に最適化することがセキュリティを達成する唯一の方法です。

楽観的なロールアップの最悪の場合、ユーザーの取引は詐欺師によって確認されません。 したがって、不正行為を争うためには、ユーザーはEthereumのフルノード、L2のフルノードを同期し、疑わしいトランザクションを計算する必要があります。

Validity Rollupの最悪の場合、ユーザーは有効性証明を検証するためにEthereumのフルノードを同期する必要があります。 計算の負担を軽減することができます

妥当なロールアップとは対照的に、楽観的なロールアップのコストは、ユーザー数ではなく取引数と直線的に調整されるため、より高価になります。

### パズルの最後の欠片

トランザクションの妥当性を保証するために、ユーザーはEthereumノードのみを実行する必要があります。 ただし、ユーザーや開発者は、さまざまな目的でRollupの状態と実行を表示し、実行したい場合があります。 *L2 ノード*はこの必要性を完全に満たします。 ユーザーがネットワーク内の取引を見ることができるだけではありません。 生態系のインフラが機能するために必要な重要なインフラでもあります The Graph, Alchemy, Infura; ChainlinkやブロックエクスプローラなどのOracleネットワークは、これらすべてのインデックスがパーミッションレスのL2ノードで完全にサポートされています。

### 結論

ブロックチェーンのスケーラビリティに誤って取り組むための多くのアプローチは、*スループットの向上*に焦点を当てています。 しかし、これはスループットがノードに与える影響を無視します。ブロックを処理し、ネットワーク履歴を保存するためのハードウェア要件が増え続けています。 どのようにネットワークの分散化を阻害するかです

Validity-proof cryptographyの出現で ブロックチェーンは**真のスケーラビリティ**を達成することができます。これにより、コストが増大し、幅広い分散化が可能になります。 同じハードウェアでより強力で複雑な計算を行うトランザクションが可能になりました。 手数料市場のジレンマを反転させるプロセス—Validity Rollupのより多くのアクティビティは、より安くなります!

[SwagtimusPrime.eth](https://twitter.com/SwagtimusP?t=pO0L1vGIhuC-ZgWOusQYtA&s=09)と[Louis Guthmann](https://twitter.com/GuthL)

1<https://bitcoin.org/en/bitcoin-core/features/requirements>

2[https://etherum.org/ja/developers/docs/nodes-and-clients/](https://ethereum.org/en/developers/docs/nodes-and-clients/)

3 From<https://docs.solana.com/running-validator/validator-reqs>

4 強く簡略化され、平均的な動的ブロックサイズで調整