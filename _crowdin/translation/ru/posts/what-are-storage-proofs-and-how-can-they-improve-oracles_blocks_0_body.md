## Введение

Доказательства хранения — это криптографический способ отслеживания информации о блокчейне, чтобы ее можно было совместно использовать в цепочках. Подобно оракулам, доказательства хранения обеспечивают доказательство того, что информация верна. Однако, в отличие от оракулов, они**доверия к третьей стороне для этого доказательства; скорее, с доказательствами хранения доверие встроено в хранилище.

В некоторых случаях доказательства хранения могут заменить оракулы. В других случаях доказательства хранения могут улучшить их и открыть новые варианты использования блокчейна, которые раньше были невозможны.

Итак, давайте подробно рассмотрим доказательства хранения — что это такое, как они работают, варианты их использования и как они могут улучшить (а иногда и заменить) оракулы.

## Что такое доказательства хранения?

Доказательства хранения позволяют открывать криптографические обязательства состояния. Их можно оптимизировать, объединив их с S\[N/T]ARKS. . Эти доказательства достоверности доказывают, что конкретное состояние существовало и было действительным в конкретном блоке в прошлом.

По сути, блокчейны — это базы данных, которые содержат данные, криптографически зафиксированные с использованием деревьев Меркла, деревьев Меркла Патриции, деревьев Веркла и т. д.). Поскольку все данные зафиксированы, мы можем доказать, что некоторая информация инкапсулирована в данном состоянии. Однако при использовании простых схем обязательств размер этого доказательства становится тем более заметным, чем больше объем данных, которые оно включает. Проверка таких доказательств в сети становится слишком дорогой, чтобы быть практичной.

Доказательства хранения, с другой стороны, при использовании в сочетании со STARK или SNARK могут быть относительно небольшими и позволять вам проверять конкретную часть состояния в определенный момент времени и в любом домене — не доверяя третьей стороне. . Вместо третьих сторон они полагаются на безопасность самой базовой цепочки.

Почему это важно? Эфириум сегодня — это не простая монолитная цепочка (L1), какой она была несколько лет назад. С появлением решений L2 данные теперь распределяются по нескольким цепочкам.

Синхронные предположения о состоянии цепи больше не могут быть сделаны. Многие решения для обмена данными уже запущены, такие как системы обмена сообщениями>L2, межсетевые мосты и оракулы. Но проблема с этими текущими решениями заключается в том, что они включают доверие к третьей стороне, такой как ретрансляторы, подписчики с мультиподписью и комитеты. Доказательства хранения позволяют нам проверять состояние блокчейна в любой момент времени, используя криптографические обязательства, не допуская доверия к третьей стороне.

## Примеры использования доказательств хранения

Поскольку доказательства хранения позволяют нам эффективно «сжимать» блокчейн и передавать данные в другое место, у них довольно много применений. Доступная стоимость проверки, неотъемлемое свойство доказательств хранения, позволяет проверять доказательство в цепочке*назначения*, сводя к минимуму необходимость разработки систем обмена сообщениями между цепочками.

Потенциальные варианты использования включают:

* **Общий доступ к информации**одной цепочки из другой о состоянии и транзакциях в блокчейне.
* **Упрощенные кроссчейн-системы голосования**. Часто пользователи держат свои активы в медленной, но более безопасной цепочке A, но некоторые голосования на основе токенов происходят в цепочке B с более дешевыми транзакциями. Это вынуждает пользователя либо пропустить свое голосование, либо заплатить огромную комиссию за транзакцию, чтобы связать свои активы с A на B, отдать свой голос, а затем связать их обратно с A. В таких случаях доказательства хранения позволяют пользователям подтвердить баланс своих токенов в цепочке A. в данном блоке и беспрепятственно отдают свой голос цепочке B.
* **Альтернатива перекрестным мостам**. В настоящее время межсетевые мосты предполагают уровень доверия к третьей стороне, поскольку они обычно включают посредника, такого как хранитель или децентрализованная автономная организация (DAO). Этот посредник отвечает за обеспечение того, чтобы определенное количество токенов было получено посредником в исходной цепочке, и за хранение активов в исходной цепочке. После этого соответствующие токены чеканятся в цепочке назначения. Доказательства хранилища могут включать ненадежные мосты между цепочками, поскольку приложение смарт-контракта в цепочке назначения может проверять транзакцию, в которой активы были переданы смарт-контракту моста в исходной цепочке, и чеканить связанные активы. Однако во многих случаях необходимость передачи активов между цепочками может быть устранена, поскольку право собственности на активы в другой цепочке может быть просто доказано доказательствами хранения.
* **Расширенный UX для вариантов использования Account Abstraction (AA)**. AA был реализован в различных цепочках и считается важным нововведением в подключении первого миллиарда пользователей к пространству блокчейна. С доказательствами хранения кошельки могут включать дополнительные функции восстановления доступа только в том случае, если кошелек не отправлял никаких транзакций в течение длительного времени. Также могут быть применены дополнительные проверки, требующие использования некоторых данных из других цепочек.

![Типичное изображение поперечного мостового потока](/assets/typical-cross.bridge-flog-imagewebp.webp "Типичное изображение поперечного мостового потока")

## Пример справки о хранении

Генерация доказательств хранения в цепочках, совместимых с EVM, проста. Например, в библиотеке Web3.js есть функция getProof, которая может генерировать подтверждение состояния контракта в Ethereum (и других цепочках, совместимых с EVM, таких как Polygon или BSC). В функцию необходимо передать адрес контракта и слот для хранения контракта.

В Ethereum смарт-контракты используют хранилище ключей и значений для хранения данных в своем хранилище. Каждая часть данных хранится в определенном месте, известном как «слот для хранения». Слоты хранилища — это области памяти в хранилище контракта, идентифицируемые уникальным индексом. Давайте посмотрим на пример смарт-контракта со следующим кодом, развернутым в основной сети Ethereum по адресу[0xcc…da8b](https://etherscan.io/address/0xcca577ee56d30a444c73f8fc8d5ce34ed1c7da8b#code).

![](/assets/blog-post-image-2-.webp)

Переменная владельца будет храниться в слоте 0. Теперь, чтобы сгенерировать доказательство того, что «владельцем» этого контракта был адрес А, мы можем использовать функцию «getProof» следующим образом:

![](/assets/blog-post-image-3-.webp)

\
Вывод кода выше выглядит примерно так:

![](/assets/blog-post-image-4-.webp)

Возвращенный «storageProof» содержит доказательство хранения для переменной «владелец». Поскольку Ethereum использует Merkle Patricia Trees для фиксации в своем состоянии состояния учетных записей и их хранилища, сгенерированное хранилище можно использовать для подтверждения слота хранилища (или состояния учетной записи). Однако, как указывалось ранее, эти доказательства недостаточно масштабируемы, чтобы обсуждать передачу сообщений между цепочками. Использование сложной математики ZK вдобавок к этому может уменьшить количество вычислений, необходимых для проверки доказательства.

## Так как же доказательства хранения сравниваются и контрастируют с оракулами?

Блокчейны по своему дизайну не могут извлекать данные вне сети. Это делает блокчейн ненадежным, но также накладывает ограничения на способность смарт-контракта принимать решения на основе реальных событий. Оракулы также обычно используются для получения исторической информации о блокчейне, поскольку получение этих данных напрямую очень сложно и, следовательно, подвержено ошибкам.

Чтобы решить эту проблему, были созданы специальные объекты с именем**оракулов**для извлечения этих данных вне сети (или для получения результатов некоторых тяжелых вычислений вне сети). В настоящее время эти оракулы требуют, чтобы третья сторона, такая как учреждение или децентрализованная сеть операторов узлов, предоставляла данные по цепочке, которые становятся общедоступными для пользователей и смарт-контрактов. Это предположение о доверии в настоящее время неизбежно, но не идеально (хотя несколько команд, таких как Pragma, работают над минимизацией этого требования к доверию).

**[Chainlink](https://chain.link/)**является примером оракула блокчейна, который предоставляет широкий спектр реальных данных (курсы акций, данные о погоде и т. д.), сервисы вычислений вне сети для минимизации стоимости тяжелых вычислений в сети и межсетевые сервисы, которые считывают и записывают информацию между разными блокчейнами.

Поскольку у смарт-контрактов нет другого способа узнать, что происходит в реальном мире, кроме использования оракулов, оракулы стали неотъемлемой частью экосистемы блокчейна.

## Состояние оракулов в Старкнете

В тестовой сети Starknet ранее упомянутая Chainlink в настоящее время предоставляет потоки данных о ценах для семи пар криптовалют и[сотрудничает с командой Starkware для «дальнейшего ускорения разработки приложений и общего роста экосистемы StarkNet»](https://www.coindesk.com/business/2023/02/06/starkware-partnering-with-chainlink-for-starknet-growth/) Chainlink сводит к минимуму предположение о доверии с помощью децентрализованной сети узлов, которые предоставляют данные из источников вне сети, но агрегация данных происходит вне сети.

**[Pragma](https://www.empiric.network/)**и**[Stork Network](https://www.stork.network/)**— два крупнейших поставщика оракулов в Starknet, работающие как в основной, так и в тестовой сети. Наряду с ценовыми тикерами для нескольких криптовалютных пар, Pragma работает над внедрением поддающейся проверке канала случайности в основной сети, которая позволит протоколам запрашивать безопасную случайность в цепочке. Ценовые потоки на Pragma основаны на представлении цен крупными учреждениями и маркет-мейкерами, а агрегирование цен происходит в сети с использованием эффективной технологии ZK.

![](/assets/blog-post-image-5-.webp)



## Можно ли заменить или улучшить оракулы доказательствами хранения?

В некоторых случаях да, доказательство хранения может заменить оракула.

Не все данные, предоставляемые оракулами, на самом деле должны быть предоставлены третьей стороной. В некоторых случаях данные, предоставленные оракулом, уже были доступны в цепочке (в виде хранилища в цепочке или транзакции), и их можно получить, взглянув на предыдущее состояние цепочки блоков. В этих случаях доказательство хранения может заменить потребность в доверии к третьей стороне и оракулу и позволить смарт-контрактам полностью полагаться на безопасность криптографических обязательств.

В других случаях, когда доказательства хранения не могут полностью заменить оракула, они часто могут**дополнительными функциями, такими как следующие:

* Оракулы передают информацию от поставщиков данных к потребителям данных. Однако не все потребители данных находятся в одной цепочке. С помощью доказательств хранения можно выполнить некоторые вычисления**на данных из разных источников и экспортировать результат в другие цепочки**.
* Предпочтительной исходной цепочкой для таких данных является цепочка с дешевыми вычислениями, а проверка доказательства может быть выполнена с минимальными затратами в других цепочках назначения.
* [Herodotus](https://www.herodotus.dev/)— один из лидеров исследований в этой области, и они предлагают междоменный доступ к данным в разных цепочках Ethereum с использованием доказательств хранения и математики ZK. Pragma также сотрудничает с Herodotus, чтобы в ближайшем будущем обеспечить поддержку кроссчейн-оракулов.
* Подтверждения хранения могут**унифицировать состояние нескольких сверток**и даже разрешить синхронное чтение*между*уровнями Ethereum.
* Еще одно усовершенствование — это**поиск исторических данных, опубликованных в сети**. Блокчейны с сохранением состояния, такие как Ethereum и Starknet, записывают и криптографически сохраняют свое состояние с помощью специализированных структур данных, таких как деревья Меркла/Веркла и MPT. Это позволяет доказать включение любых данных, хранящихся в этих структурах. Следовательно, любым прошлым данным, опубликованным в цепочке, также можно доверять, извлекать и использовать в других приложениях (даже не обязательно в той же цепочке). Эти доказательства хранения позволяют смарт-контрактам получать доступ к информации, относящейся даже к блоку генезиса.
* Pragma исследует жизнеспособность разработки оракула в качестве L3 в Starknet, откуда данные можно «извлекать» из других цепей и проверять с помощью доказательств хранения. Преимущества наличия оракула в другом домене поверх вычислительно дешевой сети, такой как Starknet, включают следующее:
* Поскольку L3 может быть гибко настраиваемой цепочкой, различные параметры можно настроить так, чтобы**быстрее достигал консенсуса по блокам**, что значительно сокращает задержку данных для оракула.
* В сочетании с доказательствами хранения**данные с малой задержкой могут быть асинхронно переданы в другие цепочки**после достижения консенсуса в исходной цепочке.
* Возможность**повысить доверие к данным**за счет разработки встроенной системы в L3 для сокращения недобросовестных поставщиков данных. При наличии соответствующих стимулов поставщики данных на L3 могли бы поставить свои активы в качестве гарантии публикации правильных данных. Поскольку консенсус всей сети на L3 необходим, прежде чем другие цепочки смогут использовать данные, данные, предоставленные оракулом, можно считать защищенными ставкой валидатора на L3.

# Заключение

За последние несколько месяцев растущее использование L2 в Ethereum дало нам более четкое представление о будущем отрасли. История L2 набирает обороты в таких сетях, как[Starknet](https://www.starknet.io/en),[Optimism](https://www.optimism.io/)и[Arbitrum](https://arbitrum.io/). Тем не менее, одной из основных опор для его роста является внедрение децентрализованной системы обмена сообщениями между сетями. Хотя они все еще находятся в зачаточном состоянии, доказательства хранения обещают невероятные решения этой проблемы.

Большое спасибо[Marcello Bardus](https://twitter.com/0xmarcello)&[Kacper Koziol](https://twitter.com/kacperkozi)за рецензирование этой статьи.