### TL;DR

* Starknet Alpha 0.7.0 выпущен для Goerli; упакован с улучшениями
* Контракты теперь можно улучшать с помощью шаблона прокси-апгрейда.
* Контракты теперь могут создавать события
* Поддержка долгожданных системных вызовов Block Number и Block Timestamp

### вступление

Мы рады выпустить Alpha 0.7.0, версию с новыми функциями и улучшениями. Одним из лучших стимулов для Starknet за последние несколько месяцев стало возросшее участие сообщества в формировании будущего Starknet. Эта версия отвечает некоторым насущным потребностям сообщества.

#### Изменения в соглашении об именах

Внимательный читатель мог заметить, что предыдущая версия Starknet Alpha называлась Alpha 4, тогда как сейчас мы выпускаем Alpha 0.7.0. Мы решили не указывать специальный номер альфа-версии и вместо этого полагаться только на соответствующую версию cairo-lang.

### Новые возможности

#### Возможность обновления контракта

OpenZeppelin[Proxy Upgrade Pattern](https://docs.openzeppelin.com/upgrades-plugins/1.x/proxies)теперь полностью поддерживается для обновлений контрактов в Starknet. Шаблон прокси — это распространенный метод, позволяющий обновлять контракты через Ethereum. Alpha 0.7.0 позволяет использовать этот шаблон в Starknet.

Мы сделали[руководство](https://starknet.io/docs/hello_starknet/default_entrypoint.html)чтобы продемонстрировать базовую реализацию шаблона, и OpenZeppelin уже усердно работает над реализацией стандартного контракта для шаблона прокси; см.[прототип](https://github.com/OpenZeppelin/cairo-contracts/pull/129).

#### Номер блока и временная метка блока

Alpha 0.7.0 добавляет два новых системных вызова, о которых просили многие разработчики. Эти вызовы позволяют контракту получить доступ к номеру блока и метке времени блока. Номер блока возвращает номер текущего выполняемого блока. Временная метка блока возвращает временную метку, заданную Sequencer при создании блока.

Вы можете увидеть пример того, как использовать эти функции в учебнике[](https://starknet.io/docs/hello_starknet/more_features.html#block-number-and-timestamp).

#### События

Сюрприз! Функция, которая была запланирована для будущей версии, пробралась в эту более раннюю.

Контракты Starknet теперь поддерживают определение и генерацию событий, что позволяет им предоставлять информацию о выполнении для использования приложениями вне сети. Разработчики Ethereum найдут семантику и синтаксис очень похожими на Solidity. Вы можете прочитать[документацию](https://starknet.io/documentation/events/)или просмотреть[учебник](https://starknet.io/docs/hello_starknet/events.html), в котором объясняется эта функция.

#### Удалена директива %builtins

Директива %builtin больше не нужна в контрактах Starknet. Это изменение последовало за обсуждением в сообществе шаблона расширения[контрактов](https://community.starknet.io/t/contract-extensibility-pattern/210)на[шаманах Starknet](https://community.starknet.io/). Это значительно упрощает использование этого шаблона расширяемости.

Например, следующий контракт будет изменен с:

```
%lang starknet

# Это директива "%builtins".
# Это больше не нужно.
%builtins range_check

@view
func add(x : войлок, y : войлок) -> (res : войлок):
return (res=x + y)
end
```

К этому:

```
%lang starknet
@view
func add(x : войлок, y : войлок) -> (res : войлок):
return (res=x + y)
end
```

Вы можете ознакомиться со стандартными контрактами[ERC-20](https://github.com/OpenZeppelin/cairo-contracts/tree/main/contracts/token), в которых используется новый шаблон.

#### Внешние функции поддерживают массивы структур

Alpha 0.7.0 поддерживает передачу и возврат массивов структур во внешние функции. Эта дополнительная функциональность позволяет контрактам с учетными записями лучше поддерживать[мультивызовов](https://github.com/OpenZeppelin/cairo-contracts/pull/73#discussion_r753535751).

Многократный вызов — это мощная функция абстракции учетной записи, которая позволяет учетной записи совершать несколько вызовов в рамках одной транзакции. Очевидным вариантом использования является создание**одиночной транзакции**, которая вызывает учетную запись, а затем осуществляет передачу от.

Мы с нетерпением ждем, что сообщество сделает с этим.

#### Улучшения интерфейса командной строки Starknet

**Поддержка ожидающих блоков**

[Блоки ожидания](https://starknet.io/documentation/block-structure-and-hash/#pending_block)были[введены](https://community.starknet.io/t/cairo-v0-6-2-api-change-pending-block/195)в последней минорной версии (v0.6.2) и предлагали более быстрые подтверждения транзакций. Эта версия включает поддержку запроса этих блоков через интерфейс командной строки Starknet.

Чтобы использовать его, в каждой команде CLI, которая принимает block_number в качестве аргумента (contract_call/get_block/get_code/get_storage_at), мы можем запросить Starknet относительно ожидающего блока, указав block_number=pending.

**Поддержка контрактов счетов**

Starknet использует абстракцию учетных записей, т. е. все учетные записи реализованы в виде смарт-контрактов. Первые реализации контрактов учетных записей были сделаны[Argent](https://github.com/argentlabs/argent-contracts-starknet)и[OZ](https://github.com/OpenZeppelin/cairo-contracts/blob/main/contracts/Account.cairo), но мы ожидаем, что их будет еще больше.

В Starknet все транзакции должны проходить через контракт учетной записи, а интерфейс командной строки теперь позволяет взаимодействовать со Starknet Alpha напрямую через контракты учетной записи. См.[учебник](https://starknet.io/docs/hello_starknet/account_setup.html#setting-up-a-starknet-account)о том, как его настроить.

Аналогичная функциональность была также добавлена в[Starknet.py](https://github.com/software-mansion/starknet.py/)и[Nile](https://github.com/OpenZeppelin/nile)в прошлом месяце.

#### Обмен сообщениями L1<>L2 в среде тестирования

Альфа 0.7.0 представляет Почтальона. Postman позволяет разработчикам использовать среду тестирования для тестирования более сложных потоков.

На высоком уровне — это высмеивает ответственность Секвенсора Старкнета за передачу сообщений от L1 к L2 и от L2 к L1. Это гарантирует, что сообщения, отправленные через контракт обмена сообщениями Solidity, появятся в целевом контракте Starknet, а сообщения, отправленные из контракта Starknet, появятся в контракте обмена сообщениями Solidity.

#### И другие функции

Alpha 0.7.0 предоставляет гораздо больше функций и изменений, таких как добавление эффективной функции извлечения квадратного корня в общую математическую библиотеку. Полный список появится в[журнале изменений](https://github.com/starkware-libs/cairo-lang/releases/tag/v0.7.0).

### Следующий?

Первоначальная поддержка[Fee Mechanism](https://community.starknet.io/t/fees-in-starknet-alpha/286/29)будет выпущена в течение нескольких недель как подверсия Starknet.

### Больше информации?

[starknet.io](https://starknet.io/): для всей информации, руководств и обновлений Starknet.

[Starknet Discord](https://discord.gg/uJ9HZTUk2Y): присоединяйтесь, чтобы получить ответы на свои вопросы, получить поддержку разработчиков и стать частью сообщества.

[Шаманы Старкнета](https://community.starknet.io/): присоединяйтесь, чтобы следить (и участвовать!) в обсуждениях исследований Старкнета.