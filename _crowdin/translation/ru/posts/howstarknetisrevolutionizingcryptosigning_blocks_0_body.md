# Как StarkNet революционизирует криптографическую подпись
## *Долой сложные ключи, пользуйтесь Face ID. Практический пример абстракции аккаунта*
В тот момент, когда люди смогут использовать знакомые методы, такие как идентификация лица, для подписи криптовалютных транзакций, мы увидим бум самообслуживания. Все знают, что использование собственного кошелька — это изначальный крипто-идеал, но это пугает, и вместо этого люди выбирают биржи. Это тематическое исследование того, как Braavos использует функциональность StarkNet под названием Account Abstraction, чтобы получить гораздо более интуитивно понятный способ использования вашего кошелька.
## Представляем абстракцию аккаунта
После скандала с FTX этот вопрос актуален как никогда. Почему люди по-прежнему предпочитают отдавать свою криптовалюту централизованным учреждениям, а не хранить ее у себя? Ответ: для большинства людей самостоятельная опека сложна. Сид-фразы — это «худший-лучший» механизм восстановления, отпугивающий многих (даже самых закоренелых дегенов). Ответ на этот вызов: абстракция аккаунта. Абстракция учетной записи позволяет кошелькам соответствовать (и превосходить) ожидания пользователей Web2, например, подписывать транзакции с использованием Face ID или двухфакторной аутентификации. Это облегчает сегментацию аккаунта и лимиты расходов; и, в конечном итоге, обеспечивает простое восстановление учетной записи и полное удаление исходной фразы. Это революция для UI и UX.
## СтаркНет
StarkNet, ведущий пакет Validity Rollup, обладает несколькими ключевыми характеристиками, которые делают его наиболее многообещающим решением для масштабирования Ethereum. Основываясь на доказательствах STARK, он обеспечивает низкую плату за газ без ущерба для безопасности Ethereum. Послужной список доказательств STARK, поддерживающих StarkEx, включает 800 миллиардов долларов совокупного объема торгов, 300 миллионов транзакций и 90 миллионов NFT. Возможности доказательств STARK для обеспечения низких комиссий в сочетании с мощью абстракции учетных записей позволили Braavos разработать инновационные возможности кошелька, к которым он стремится.
## Контекст
Большинство основных блокчейнов, включая Биткойн и Эфириум, используют схемы криптографической подписи на основе эллиптических кривых secp256k1 (см.[здесь](http://ethanfast.com/top-crypto.html)для полного списка). Эта реализация эллиптической кривой считается надежной — ее используют многие блокчейны, и она выдержала испытание временем. Но он несовместим со схемой криптографической подписи, доступной в аппаратных модулях безопасности мобильных устройств (HSM), таких как iPhone и телефоны Android (Pixel и другие). В этих устройствах используется другая кривая — secp256r1 (она же NIST-P256). Это означает, что пользователи этих блокчейнов не могут воспользоваться микросхемами безопасности на своих устройствах и должны по умолчанию использовать аппаратные кошельки, если хотят получить высокий уровень безопасности. Это серьезно ограничивает любые инновации UX в отношении того, как пользователи могут входить в кошелек и подтверждать транзакции (отсюда и повсеместное распространение начальных фраз). StarkNet не поддерживает secp256r1 и имеет собственную проприетарную кривую, удобную для STARK. Но в отличие от других блокчейнов, на платформе StarkNet изначально доступна абстракция учетной записи, что открывает новый мир UX-возможностей для приложений-кошельков. Braavos использовала эту возможность, чтобы представить Hardware Signer.
## Подписчик оборудования
Аппаратная подпись состоит из двух основных частей:
* Защищенная подсистема в мобильном устройстве пользователя * Смарт-контракт учетной записи, который может запускать произвольную логику (также известная как абстракция учетной записи)
## Безопасная подсистема
Подписывающее оборудование использует подсистему безопасности, встроенную в устройство пользователя — защищенный анклав</strong>iPhone**или HSM**Titan**телефона Android — для защиты учетной записи. ![](https://miro.medium.com/max/1400/0*EPm8q10ykvFGnvcv) Чип Secure Enclave / Titan представляет собой выделенную и изолированную подсистему, полностью отделенную от процессора приложений, который может генерировать закрытые ключи и подписывать сообщения. Он генерирует ключи с помощью внутреннего генератора случайных чисел (TRNG) и подписывает сообщения по эллиптической кривой NIST-P256 (secp256r1) с помощью внутреннего ускорителя открытых ключей (PKA). Закрытые ключи никогда не покидают защищенную систему и неизвестны/недоступны никому, даже пользователю или самому приложению. Это означает, что даже если ядро процессора приложений устройства будет скомпрометировано, пользовательские ключи останутся в безопасности! ![](https://miro.medium.com/max/1400/0*yHJ--fK8keNdTci8)</p>
## Более глубокое погружение в безопасный анклав
В процессе производства чипа TRNG генерирует UID (уникальный идентификатор), который сохраняется в PKA. Он не может быть прочитан и никогда не покидает PKA, поэтому он неизвестен даже процессору Secure Enclave и операционной системе процессора Secure Enclave (SepOS). Этот UID представляет собой случайное число, уникальное для каждого устройства и используемое для шифрования всех других ключей, которые будут сгенерированы в будущем на этом устройстве.\ Это работает следующим образом: приложение запрашивает SepOS для создания нового ключа. -pair, SepOS даст команду Secure Enclave TRNG сгенерировать ключ и зашифровать его (используя UID). Затем приложение может запросить у SepOS расшифровку ключа и подписать сообщение с помощью сгенерированного ключа. В течение всего этого процесса сгенерированный ключ не покидает анклав и никому не известен. (Для получения дополнительной информации о Secure Enclave см.[здесь](https://support.apple.com/en-il/guide/security/sec59b0b31ff/web)). Способ построения и работы Secure Enclave, а также тот факт, что он является целью для атак со стороны влиятельных корпораций и правительств по всему миру, являются причиной того, что его безопасность превосходит стандартные аппаратные кошельки.
## Абстракция аккаунта
Сила Braavos как кошелька на основе смарт-контрактов поверх StarkNet заключается в том, что он состоит из двух столпов:
* Клиентская сторона (например, приложение), которая позволяет пользователю просматривать/подписывать транзакции и отправлять их в цепочку. * Ончейн-сторона — имеет смарт-контракт учетной записи, который может запускать произвольную логику; и, в частности, в нашем случае запустить произвольную логику проверки подписи****. Приложение подписывает транзакцию с помощью модуля безопасности мобильного устройства, а затем отправляет ее в контракт учетной записи в сети, который может ее проверить. Как упоминалось выше, модуль безопасности на iPhone и телефонах Android использует криптографию под названием NIST-P256 (secp256r1), которая не совместима ни с одной из основных криптографических схем блокчейна, включая StarkNet. Вот почему наличие учетной записи смарт-контракта в сети, через которую проходят все транзакции и может выполняться произвольная логика, имеет решающее значение при использовании этих HSM на iPhone и телефонах Android. ![](https://miro.medium.com/max/1400/0*1gItqYMJgmpu_fXc)
## Биометрия
Как пользователь подтверждает транзакцию через кошелек Braavos? Может ли вредоносное приложение просто автоматически подписать транзакцию без согласия пользователя? Нет!! Преимущество встроенного в мобильные устройства модуля безопасности, такого как Secure Enclave, заключается в том, что он поддерживает встроенную биометрическую аутентификацию пользователя. Это означает, что даже фактическое утверждение для подписания транзакции осуществляется напрямую через Secure Enclave. Подтверждение не проходит через приложение, и пользователю нужно будет подтвердить транзакцию своим отпечатком пальца или идентификацией лица.
## Восстановление
Если закрытый ключ никто не знает, что произойдет, если устройство потеряется или заблокируется? Как пользователь может вернуть контроль над учетной записью? В Braavos у учетной записи фактически будет 2 открытых ключа — ключ подписчика оборудования, который будет использоваться для подписи всех транзакций, и ключ, полученный из исходной фразы, который может подписывать только одну транзакцию — «Запрос на удаление подписчика оборудования». Этот запрос не будет выполнен немедленно, а будет иметь временную задержку в 4 дня (настраивается), чтобы позволить пользователю использовать аппаратную подпись для отмены такого запроса. Это означает, что если устройство будет украдено/потеряно/заблокировано, пользователи все равно смогут восстановить свою учетную запись в течение 4 дней. Однако, если их Seed Phrase будет украдена и злоумышленник отправит запрос на удаление Hardware Signer, пользователь автоматически (и неоднократно) получит уведомление на свое мобильное устройство и сможет отменить запрос и сохранить все активы в безопасности. .
## Краткое содержание
Функция Hardware Signer предлагает как самый современный уровень безопасности для криптографических пользователей, так и опыт, к которому пользователи привыкли из web2. В этом смысле подписание транзакции так же гладко и беззаботно, как и оплата через Apple/Google Pay. Это всего лишь один, но выдающийся пример мощности StarkNet, кошелька на основе смарт-контрактов (он же Account Abstraction) и нового пространства дизайна, которое он предоставляет. Мы предвидим развитие все новых и новых возможностей, которые приведут криптоиндустрию к лучшему и более инклюзивному будущему, предоставляя как новым, так и существующим пользователям бескомпромиссную безопасность в сочетании с бескомпромиссным UX.