### TL;DR

* **עמלות חובה כעת ב-Testnet, בקרוב ב-Mainnet**
* דפוס מפעל חוזה אפשרי כעת!
* StarkNet מציגה שיעורי חוזים
* שיחת נציג מוחלפת בשיחת ספרייה

### הקדמה

אנו שמחים להציג את StarkNet Alpha 0.9.0! זוהי גרסה חשובה שבה StarkNet עושה צעדים משמעותיים לקראת בגרות, עם תוספות משמעותיות הן לפונקציונליות והן לעיצוב הפרוטוקול.

**עמלות הן חובה**(כרגע רק ב-Testnet, עד שגרסה 0.9.0 תהיה פעילה ב-Mainnet) - לכל L2 משגשגת חייבת להיות מערכת עמלות עצמאית משלה. לאחר הצגת עמלות כתכונה אופציונלית בגרסה 0.8.0, כעת אנו מרגישים בטוחים לכלול אותם כמרכיב ליבה של הפרוטוקול, ולהפוך אותם לחובה. פרטים נוספים בהמשך.

שינוי משמעותי נוסף ברמת הפרוטוקול הוא הכנסת מחלקות חוזה והפרדת מחלקה/מופע. זה מאפשר שימוש פשוט יותר בפונקציונליות \`delegate_call\` ובפריסות מחוזים קיימים, מה שמאפשר את דפוס היצרן ב-StarkNet.

### שיעורי חוזה

מתוך השראה מתכנות מונחה עצמים, אנו מבחינים בין קוד החוזה לבין היישום שלו. אנו עושים זאת על ידי הפרדת חוזים לשיעורים ומופעים.

חוזה**מחלקה**היא ההגדרה של החוזה: קוד הביטים של קהיר, מידע רמז, שמות נקודות כניסה וכל מה שצריך כדי להגדיר באופן חד משמעי את הסמנטיקה שלו. כל מחלקה מזוהה לפי ה-hash המחלקה שלה (בדומה לשם מחלקה משפות OOP).

מופע**חוזה**, או פשוט חוזה, הוא חוזה פרוס המתאים למחלקה כלשהי. שימו לב שרק מופעי חוזה מתנהגים כחוזים, כלומר יש להם אחסון משלהם וניתנים להתקשרות על ידי עסקאות/חוזים אחרים. למחלקת חוזה אין בהכרח מופע פרוס ב-StarkNet. הצגת השיעורים מגיעה עם מספר שינויים בפרוטוקול.

#### 'הכרז' על עסקה

אנו מציגים סוג חדש של עסקה ל-StarkNet: עסקת['הכרז'](https://docs.starknet.io/docs/Blocks/transactions#declare-transaction), המאפשרת להכריז על חוזה**class.**בניגוד לעסקת \`deploy\`, פעולה זו אינה פורסת מופע של אותה מחלקה. מצב StarkNet יכלול רשימה של מחלקות מוצהרות. ניתן להוסיף מחלקות חדשות באמצעות העסקה החדשה של \`declare\`.

#### מפעלי הקריאה והחוזה של מערכת 'פרוס'.

ברגע שהוכרזה מחלקה, כלומר, העסקה המתאימה של \`declare\` התקבלה, נוכל לפרוס מופעים חדשים של המחלקה הזו. לשם כך, אנו משתמשים בקריאת המערכת החדשה \`deploy\`, אשר לוקחת את הארגומנטים הבאים:

* ה-hash של הכיתה
* מלח
* טיעוני קונסטרוקטור

ה-'deploy' syscall אז תפרוס מופע חדש של אותה מחלקת חוזה, שכתובת[שלו](https://docs.starknet.io/docs/Contracts/contract-address)תיקבע על ידי שלושת הפרמטרים שלמעלה וכתובת ה-deployer (החוזה שהפעיל את קריאת המערכת).

הכללת פריסות בתוך עסקת invoke מאפשרת לנו לתמחר ולגבות עמלות עבור פריסות, מבלי שנצטרך להתייחס אחרת לפריסות ופניות. למידע נוסף על דמי פריסה, ראה[המסמכים](https://docs.starknet.io/docs/Fees/fee-mechanism#deployed-contracts).

תכונה זו מציגה מפעלי חוזה לתוך StarkNet, מכיוון שכל חוזה עשוי להפעיל את ה-\`deploy\` syscall, וליצור חוזים חדשים.

#### מעבר מ'שיחת נציג' ל'שיחת ספרייה'

הכנסת המחלקות מאפשרת לנו לטפל בבעיה ידועה במנגנון הנציגים של Ethereum: כאשר חוזה מבצע קריאת נציג לחוזה אחר, הוא צריך רק את המחלקה שלו (הקוד שלו) ולא מופע ממשי (האחסון שלו). הצורך לציין מופע חוזה ספציפי בעת ביצוע קריאת נציג הוא אפוא נוהג גרוע (אכן, זה הוביל לכמה באגים בחוזי Ethereum) - רק המחלקה צריכה להיות מוגדרת.

קריאת המערכת הישנה \`delegate_call\` הופכת כעת משימוש (חוזים ישנים שכבר נפרסו ימשיכו לתפקד, אך**חוזים המשתמשים ב-\`delegate_call\` לא יקדרו עוד**), ומוחלפת בקריאה חדשה למערכת library_call אשר מקבל את ה-hash המחלקה (של מחלקה שהוכרזה בעבר) במקום כתובת מופע חוזה. שימו לב שרק חוזה אחד בפועל מעורב בשיחת ספרייה, ולכן אנו נמנעים מהעמימות בין החוזה המתקשר לחוזה היישום.

#### נקודות קצה חדשות של API

הוספנו שתי נקודות קצה חדשות ל-API, המאפשרות אחזור של נתונים הקשורים לכיתה:

* \`get_class_by_hash\`: מחזירה את הגדרת המחלקה בהינתן ה-hash של המחלקה
* \`get_class_hash_at\`: מחזיר את ה-class hash של חוזה פרוס בהינתן כתובת החוזה

שים לב שכדי להשיג את המחלקה של חוזה פרוס ישירות, במקום לעבור את שתי השיטות שלמעלה, אתה יכול להשתמש בנקודת הסיום הישנה \`get_full_contract\`, ששמה ישונה בגרסאות עתידיות. כל נקודות הקצה שהוזכרו לעיל ניתנות לשימוש גם מ[StarkNet CLI](https://docs.starknet.io/docs/CLI/commands).

#### עמלות

אנו ממשיכים לשלב עמלות ב-StarkNet, מה שהופך אותן לחובה (תחילה ב-Testnet, ובהמשך גם ב-Mainnet) עבור עסקאות ``[invoke](https://docs.starknet.io/docs/Blocks/transactions#invoke-function)\`. העסקה \`הצהר\` לא תדרוש עמלות בשלב זה. באופן דומה, \`פרוס`` טרנזקציות גם לא ידרשו עמלה, עם זאת, שים לב שסוג עסקה זה ככל הנראה ייצא משימוש בגרסאות עתידיות.

נותרו מספר שאלות פתוחות בתחום זה, כאשר הבולטות שבהן הן כיצד לגבות עמלות עבור הצהרות חוזים ופריסה של חשבונות StarkNet. אנו נטפל בבעיות אלו בגרסאות עתידיות.

### מה הלאה?

בעקבות מפת הדרכים שלנו שעליה הכרזנו</a>

בפברואר, אנו מחויבים לשפר את הביצועים של StarkNet בכלל, ואת הביצועים של הרצף בפרט, כדי לקבל משוב מהיר יותר למשתמשים על העסקאות שלהם. בגרסה הבאה, אנו מתכננים להכניס מקביליות לרצף, מה שמאפשר ייצור בלוק מהיר יותר.</p> 

הגרסה הגדולה הבאה של StarkNet תתמקד במבנה החשבונות של StarkNet, באופן דומה ל[ERC-4337](https://medium.com/infinitism/erc-4337-account-abstraction-without-ethereum-protocol-changes-d75c9d94dc4a). עם זה, נסיים את הדרך שבה חשבונות StarkNet מתנהגים, ונעשה עוד צעד גדול לקראת אימוץ המוני!