### TL;DR

* **Testnet上的费用是强制性的，很快就在Mainnet上**
* 合同工厂模式现在是可能的！
* StarkNet正在引入合同类
* 代用呼叫已被替换为库调用

### 简介

我们很高兴介绍StarkNet Alpha 0.9.0！ 这是一个重要的版本，StarkNet为成熟迈出了重要的一步，功能和协议设计都有大量增加。

**费用是强制性的**(目前只在 Testnet上使用，直到版本 0.9)。 任何繁荣的L2都必须有自己的独立收费制度。 在0.8版本中引入收费作为可选功能后， 现在，我们有信心将其作为议定书的核心组成部分，并使其成为强制性的。 更多细节如下。

协议一级的另一个重大变化是采用合同类别和班级/班级分离。 这允许更直接地使用 \`delegate_call\` 功能和现有合约的部署，从而启用了StarkNet上的出厂模式。

### 合同类

我们从面向对象的编程中得到启发，对合同代码及其实施加以区分。 我们这样做是将合同分为班级和班级。

**合同类**是合同的定义：其开罗字节代码。 提示信息、入境点名称以及明确界定其语义所需的一切。 每个类通过其类散列来识别(类似于来自OOP 语言的类名称)。

**合同实例**，或只是一项合同，是与某些类相应的部署合同。 请注意，只有合同实例作为合同行事，即有自己的储存，并可通过交易/其他合同收回。 合同类不一定在StarkNet有一个部署的实例。 课程的引入伴随着协议的一些修改。

#### “申报”交易

我们正在向StarkNet引入一种新类型的交易：['声明'](https://docs.starknet.io/docs/Blocks/transactions#declare-transaction)交易，允许申报一个合同**类。**与\`depu\`交易不同，这不会部署该类的实例。 StarkNet状态将包括一个已声明的类列表。 新类可以通过新的 \`声明\` 交易添加。

#### “部署”系统呼叫和合同工厂。

一旦一个类被申报，即对应的 \`declarre\` 交易被接受，我们可以部署该类的新实例。 为此目的，我们使用新的 \`depu\` 系统调用，它需要以下参数：

* 类哈希值
* 盐类
* 构造器参数

“部署”系统后会部署一个新的合同类实例， 其[地址](https://docs.starknet.io/docs/Contracts/contract-address)将由上述三个参数和部署器地址 (调用系统调用的合同) 来确定。

在调用交易中包括部署可以让我们对部署的价格和收费，而不必以不同的方式对待部署和调用。 欲了解更多关于部署费用的信息，请参阅[文档](https://docs.starknet.io/docs/Fees/fee-mechanism#deployed-contracts)。

此功能将合同工厂引入StarkNet, 因为任何合同都可以使用 \`deposit\` syscall, 创建新合同。

#### 从'Delegate Call'移动到'Library Call'

引入类使我们能够解决Etherum的授权呼叫机制中一个众所周知的问题：当合同执行另一个合同时， 它只需要它的类(其代码)，而不是一个实际实例(其存储)。 因此，在给代表打电话时必须指定具体的合同实例是错误的做法(实际上是如此) 它导致了以太坊合同中的几个bug——只需要具体规定类别。

旧的 \`delegate_call\` 系统调用现在已被废弃(已经部署的旧合同将继续运行) 但**合同使用 \`delegate_call\` 将不再编译**， 并且被一个新的 libr_calls 系统调用取代，它可以获取类散列(以前声明的类) 而不是合同实例地址。 请注意，图书馆电话只涉及一项实际合同，因此我们避免了电话合同和执行合同之间的模糊性。

#### 新 API 端点

我们为 API 添加了两个新的终点，允许检索类相关数据：

* \`get_class_by_hash\`: 返回给定类哈希的类定义
* \`get_class_hash_at\`: 根据合同地址返回部署合同的类哈希

注意直接获得部署合同类别，而不是采用上述两种方法， 你可以使用旧的 \`get_full_contract\` 端点，它将在未来的版本中重新命名。 上述所有端点也可从[StarkNet CLI](https://docs.starknet.io/docs/CLI/commands) 使用。

#### 费用

我们着手将费用并入StarkNet，使其成为 ``[invoke](https://docs.starknet.io/docs/Blocks/transactions#invotke-function)\` 交易的必填项 (首先在 Testnet, 然后也在 Mainnet) 。 \`声明\`交易在此点不需要费用。 同样，\`部署`` 交易也不需要收费，但注意这种交易类型很可能在未来的版本中被废弃。

在这方面仍然存在若干未决问题，其中最突出的问题是如何对合同申报和StarkNet账户的部署收取费用。 我们将在今后的版本中处理这些问题。

### 下一步是什么？

根据我们的[于2月](https://medium.com/starkware/starknet-on-to-the-next-challenge-96a39de7717)宣布的路线图，我们致力于提高StarkNet的总体性能。 以及序列器的性能，特别是为了让用户更快地反馈他们的交易。 在下一版本中，我们计划在序列器中引入平行化，使区块生产更快。

StarkNet的下一个主要版本将以StarkNet账户的结构为重点，其方式类似于[ERC-4337](https://medium.com/infinitism/erc-4337-account-abstraction-without-ethereum-protocol-changes-d75c9d94dc4a)。 这样，我们将完成StarkNet账户的运作方式，朝着大规模收养迈出又一大步！